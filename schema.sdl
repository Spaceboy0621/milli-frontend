scalar Date

schema {
  query: query
  mutation: mutation
}

"Annotations object"
type annotation {
  "GraphID for annotation node"
  graphId: String
  context: String!

  "id"
  id: String!

  "object type"
  type: String!

  "Annotation motivation"
  motivation: String!

  "The agent responsible for creation of annotation"
  creator: creator!

  "The date-time of creation of annotation"
  created: String!

  "The agent responsible for generation of annotation"
  generator: generator!

  "Date-time of generation of annotation"
  generated: String!

  "Annotation body"
  body: bodyType

  "Annotation target"
  target: targetType!
}

input annotationInput {
  targetId: String!
  motivation: String!
  body: bodyInput!
  target: target!
  concept: String
}

input bodyInput {
  typ: String!
  motivation: String!
  value: String!
  format: String!
  language: String!
  creator: String!
}

"Can be one of TextualBodyType, etc."
union bodyType = textualBody

input comment {
  targetId: String!
  value: String!
}

type creator {
  id: String!
  typ: String!
  name: String!
  nickname: String!
}

input crosswalk {
  args: [mappingPair!]!
}

type generator {
  id: String!
  typ: String!
  name: String!
  homepage: String!
}

input ingestWithCrosswalk {
  url: String!
  crosswalk: crosswalk!
}

input mappingPair {
  val1: String!
  val2: String!
}

type mutation {
  ingestWithCrosswalk(ingestWithCrosswalk: ingestWithCrosswalk!): niosxEntity
  addEntity(niosxEntityInput: niosxEntityInput!): niosxEntity
  addAnnotation(annotation: annotationInput!): annotation
  addComment(comment: comment!): annotation
}

enum ImageSize {
  SMALL
  MEDIUM
  LARGE
}

type Image {
  src: String!
  alt: String
  size: ImageSize
}

type niosxEntity {
  graphId: String!
  agencyCode: String!
  recordId: String!
  unitId: String!
  title: String!
  partner: String
  subjects: [String!]
  dateOfCreation: String!
  extent: String!
  level: String!
  images: [Image!]
  annotations: [annotation!]
}

input niosxEntityInput {
  agencyCode: String!
  recordId: String!
  unitId: String!
  title: String!
  creator: String!
  dateOfCreation: String!
  extent: String!
  level: String!
}

input DateRangeInput {
  from: Date
  to: Date
}

type DateRange {
  from: Date
  to: Date
}

input filterEntityInput {
  blob: String
  # use `id` from `Language` 
  lang: String
  date: DateRangeInput
  subjects: [String!]
  people: [String!]
  places: [String!]
  partners: [String!]
  mediaTypes: [String!]
}

type FilterValue {
  id: String!
  displayName: String!
  recordCount: Int
  isSelected: Boolean
}

type EntityFilter {
  blob: String
  date: DateRange!
  lang: [FilterValue!]
  subjects: [FilterValue!]
  people: [FilterValue!]
  places: [FilterValue!]
  partners: [FilterValue!]
  mediaTypes: [FilterValue!]
}

type PageEdge {
  node: niosxEntity!
  cursor: String!
  offset: Int
  # true if node is a direct match
  isDirectMatch: Boolean
  # null if no annotation matches
  annotationMatchCount: Int
}

type PageInfo {
  pageNumber: Int
  endCursor: String
  hasNextPage: Boolean
  filters: EntityFilter
}

type Page {
  edges: [PageEdge!]
  pageInfo: PageInfo!
}

type query {
  "Finding Aid for a given collection (fonds, record group, manuscript group, etc.)"
  document(id: String!): niosxEntity

  "Look up an entity with its graphId"
  findEntity(id: String!): niosxEntity

  "All documents in the archive."
  allCollections: [niosxEntity!]!
  
  "Query for Entities"
  searchCollections(first: Int = 10, afterCursor: String, filterBy: filterEntityInput): Page!
}

type specificResourceType {
  typ: String!
  source: String!
  targetId: String
}

input target {
  source: String!
  targetId: String
}

"Can be one of SpecificResource, etc."
union targetType = specificResourceType

type textualBody {
  typ: String!
  purpose: String!
  value: String!
  format: String!
  language: String!
  creator: String!
}
